 2018.5.4  下午

做一个小风扇，加上蓝牙控制。



2018.5.5  上午
实现自然风，

当同时使用定时器0和串口的时候，会出现串口无法接收的情况，有一下一些原因：

1、
定时器0的模式设置方式不对，应该写成或的形式：TMOD |= 0X20;

2、
定时器中断服务程序太长，一般要让中断服务尽量简单。

3、
定时器中断频率太快，也就是定时器时间太短了，导致中断占用了太多的CPU资源。

4、一般在串口中断函数中，先关闭总中断（EA = 0;），离开函数的时候在打开。

2018.5.6  上午

今天把定时器定时时间改为了200us，并且在串口中断中加入了关闭总中断EA，目前能够实现接收串口发送过来的指令，但是并不是100%的都能接收到，有时候就收不到。

另外，自然风还是不能实现风速的变化。

难道还是中断来的太频繁？200us已经是极限了，不然可调档位就没了。
要不要把串口的优先级调高一点？

不知道是不是我的错觉，我把定时器0中断函数里面用到的几个变量声明前面加了volatile之后，竟然串口的接受效率提高了！现在几乎每次都能接收到。


现在其他的情况都还好，但是一旦切换到nature模式，就很难在切换到其他模式了。发送其他的命令，串口都接收不到.

已解决，设置一下中断优先级寄存器就可以了，IP寄存器，把串口中断优先级设为最高，像这种比较重要，但是中断发生频率又很低的中断，优先级最好设置的高一点，应为他对总体程序的影响个很小。

银燕XA2212电机，速度和设置的不一致。最低占空比不能为0码？0.7-1.9？
听不懂电机的提示音。
声音是电调驱动电机发出的，应该查看电调的声音提示手册。
电机还没调好，物理结构也是个问题啊。动手能力和创新力很重要。


2018.5.7  下午

还是不行，看了一下APM的输出波形，也是5v的峰值电压，500hz 的pwm波啊。而且他刚开始就是50%的占空比

电调一般是50hz的pwm波，他只关注pwm波的高电平持续时间作为油门的大小。最高最低油门是高电平持续时间为1000us和2000us，但是遥控器输出的占空比非常细腻，而我只有十级可调，1000us 的时候电机不转，1200us 的时候，转速就非常的快了，我定时200us，那么就是中断5次和中断6次的问题，这样的话，我中间就没有数据可以给了。这是一个矛盾，要么就是吧中断时间设置的非常小，然后累计很多次中断来作为频率、








